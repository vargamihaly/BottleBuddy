# Backend API Development Dockerfile

FROM mcr.microsoft.com/dotnet/sdk:9.0

WORKDIR /app

# Install dotnet-ef tools
RUN dotnet tool install --global dotnet-ef
ENV PATH="${PATH}:/root/.dotnet/tools"

# Copy project files only (skip solution to avoid docker-compose.dcproj reference issue)
COPY src/BottleBuddy.Api/BottleBuddy.Api.csproj ./src/BottleBuddy.Api/
COPY src/BottleBuddy.Core/BottleBuddy.Core.csproj ./src/BottleBuddy.Core/
COPY src/BottleBuddy.Persistence/BottleBuddy.Persistence.csproj ./src/BottleBuddy.Persistence/

# Restore dependencies for the specific project
RUN dotnet restore ./src/BottleBuddy.Api/BottleBuddy.Api.csproj

# Copy source code
COPY . .

WORKDIR /app/src/BottleBuddy.Api

# Expose port
EXPOSE 3668

# Start the application with hot reload
CMD ["dotnet", "watch", "run", "--urls", "http://0.0.0.0:3668"]
